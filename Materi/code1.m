% A=[0.2 0 0.3 0 0.5;
%    0.2 0 0 0.3 0.5;
%    0.2 0.1 0 0.7 0;
%    0.2 0.2 0.6 0 0;
%    0.2 0.2 0.6 0 0];

A=[0 0 0.3 0 0.5;
   0.2 0 0 0.3 0.5;
   0.2 0.1 0 0.7 0;
   0.2 0.2 0.6 0 0;
   0.2 0.2 0.6 0 0];

Bx=[0 1 -1 1 -1;
   -1 0 -2 0 -2;
    1 2 0  2  0;
   -1 0 -2 0 -2;
   1 2 0  2 0];

By=[0 -1 -1 1 1;
   1 0 0 2 2;
   1 0 0 2 2;
   -1 -2 -2 0 0;
   -1 -2 -2 0 0];

%A=A.*1/5
x=[2 4 5 5 1];
y=[1 2 4 3 5];
t=51;
xk=zeros(t,5);
yk=zeros(t,5);
xk(1,:)=x;yk(1,:)=y;
for k=2:t
for i=1:5
    ux=0;
    uy=0;
    for j=1:5
        ux=ux+A(i,j)*(xk(k-1,j)-xk(k-1,i)-Bx(i,j));
        uy=uy+A(i,j)*(yk(k-1,j)-yk(k-1,i)-By(i,j));
    end
    if ux>0.5;ux=0.5;else if ux<-0.5;ux=-0.5;end;end
    if uy>0.5;uy=0.5;else if uy<-0.5;uy=-0.5;end;end
    %A(i,:)
    %xk(k-1,:)
   %xk(k,i)=A(i,:)*(xk(k-1,:))';
   xk(k,i)=xk(k-1,i)+ux;
   yk(k,i)=yk(k-1,i)+uy;
   %yk(k,i)=A(i,:)*(yk(k-1,:))';
end
end
xk